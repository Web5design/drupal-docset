<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Drupal: includes/update.inc File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Drupal
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">includes/update.inc File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_drupal_update_exception.html">DrupalUpdateException</a></td></tr>
<tr><td colspan="2"><h2><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:acba191c88d6f0e38bec3a5f873f57108"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8inc.html#acba191c88d6f0e38bec3a5f873f57108">REQUIRED_D6_SCHEMA_VERSION</a> </td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab86cb0f00b89fc52f7f6294be9a1e33c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8inc.html#ab86cb0f00b89fc52f7f6294be9a1e33c">update_fix_compatibility</a> ()</td></tr>
<tr class="memitem:a39592132a77fd791c44a8d6faf362cb0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8inc.html#a39592132a77fd791c44a8d6faf362cb0">update_check_incompatibility</a> ($name, $type= 'module')</td></tr>
<tr class="memitem:ae3ce2c866dce2d33c363b57136a2ba84"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8inc.html#ae3ce2c866dce2d33c363b57136a2ba84">update_prepare_d7_bootstrap</a> ()</td></tr>
<tr class="memitem:a349ad25ac5547fbb44556538758988a2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8inc.html#a349ad25ac5547fbb44556538758988a2">update_fix_d7_block_deltas</a> (&amp;$sandbox, $renamed_deltas, $moved_deltas)</td></tr>
<tr class="memitem:a00697f7fb179855f3c3fa65105abee94"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8inc.html#a00697f7fb179855f3c3fa65105abee94">update_fix_d7_requirements</a> ()</td></tr>
<tr class="memitem:a4c65cc44fc9d615c6f69ac8ecb57bf5a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8inc.html#a4c65cc44fc9d615c6f69ac8ecb57bf5a">update_fix_d7_install_profile</a> ()</td></tr>
<tr class="memitem:a39f4938dea0ce704d1e426243cec11ec"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8inc.html#a39f4938dea0ce704d1e426243cec11ec">update_parse_db_url</a> ($db_url, $db_prefix)</td></tr>
<tr class="memitem:a1e41248922d100f2412b8471c05c59be"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8inc.html#a1e41248922d100f2412b8471c05c59be">update_get_d6_session_name</a> ()</td></tr>
<tr class="memitem:ac46854f64e50a81361ed8816b8f0ce7e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8inc.html#ac46854f64e50a81361ed8816b8f0ce7e">update_do_one</a> ($module, $number, $dependency_map, &amp;$context)</td></tr>
<tr class="memitem:aa4dd3d84e553f6bf25ad19608152d5b7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8inc.html#aa4dd3d84e553f6bf25ad19608152d5b7">update_batch</a> ($start, $redirect=NULL, $<a class="el" href="common_8inc.html#a43b2a0594431556db49df980801d8807">url</a>=NULL, $batch=array(), $redirect_callback= '<a class="el" href="group__http__handling.html#ga5b68d7a934713d1d623b2b32a732235d">drupal_goto</a>')</td></tr>
<tr class="memitem:a80f7fdd8ca66ebda4959b9429fc343f3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8inc.html#a80f7fdd8ca66ebda4959b9429fc343f3">update_finished</a> ($success, $results, $operations)</td></tr>
<tr class="memitem:ae95fb5ec58e85fd5c10c56345fd7cabe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8inc.html#ae95fb5ec58e85fd5c10c56345fd7cabe">update_get_update_list</a> ()</td></tr>
<tr class="memitem:aa931d6cdddc2e9e0ec96d240523056e9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8inc.html#aa931d6cdddc2e9e0ec96d240523056e9">update_resolve_dependencies</a> ($starting_updates)</td></tr>
<tr class="memitem:ad268e1662e1d06a85f3d51dfec9955b2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8inc.html#ad268e1662e1d06a85f3d51dfec9955b2">update_get_update_function_list</a> ($starting_updates)</td></tr>
<tr class="memitem:aafca47c65645d8463d85a3fa7884c220"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8inc.html#aafca47c65645d8463d85a3fa7884c220">update_build_dependency_graph</a> ($update_functions)</td></tr>
<tr class="memitem:ab41c0d635b6a220d269146f778a6a245"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8inc.html#ab41c0d635b6a220d269146f778a6a245">update_is_missing</a> ($module, $number, $update_functions)</td></tr>
<tr class="memitem:a6ccab16044efda416011fc20367d9344"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8inc.html#a6ccab16044efda416011fc20367d9344">update_already_performed</a> ($module, $number)</td></tr>
<tr class="memitem:af82e7fa9b13df713eb110a4e782b0e69"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8inc.html#af82e7fa9b13df713eb110a4e782b0e69">update_retrieve_dependencies</a> ()</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Drupal database update API.</p>
<p>This file contains functions to perform database updates for a Drupal installation. It is included and used extensively by <a class="el" href="update_8php.html">update.php</a>. </p>
</div><hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="acba191c88d6f0e38bec3a5f873f57108"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="update_8inc.html#acba191c88d6f0e38bec3a5f873f57108">REQUIRED_D6_SCHEMA_VERSION</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Minimum schema version of Drupal 6 required for upgrade to Drupal 7.</p>
<p>Upgrades from Drupal 6 to Drupal 7 require that Drupal 6 be running the most recent version, or the upgrade could fail. We can't easily check the Drupal 6 version once the update process has begun, so instead we check the schema version of system.module in the system table. </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a6ccab16044efda416011fc20367d9344"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8inc.html#a6ccab16044efda416011fc20367d9344">update_already_performed</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>number</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Determines if a module update has already been performed.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$module</td><td>The name of the module. </td></tr>
    <tr><td class="paramname">$number</td><td>The number of the update within that module.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>TRUE if the database schema indicates that the update has already been performed; FALSE otherwise. </dd></dl>

</div>
</div>
<a class="anchor" id="aa4dd3d84e553f6bf25ad19608152d5b7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8inc.html#aa4dd3d84e553f6bf25ad19608152d5b7">update_batch</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>redirect</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>url</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>batch</em> = <code>array()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>redirect_callback</em> = <code>'<a class="el" href="group__http__handling.html#ga5b68d7a934713d1d623b2b32a732235d">drupal_goto</a>'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Start the database update batch process.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$start</td><td>An array whose keys contain the names of modules to be updated during the current batch process, and whose values contain the number of the first requested update for that module. The actual updates that are run (and the order they are run in) will depend on the results of passing this data through the update dependency system. </td></tr>
    <tr><td class="paramname">$redirect</td><td>Path to redirect to when the batch has finished processing. </td></tr>
    <tr><td class="paramname">$url</td><td>URL of the batch processing page (should only be used for separate scripts like <a class="el" href="update_8php.html">update.php</a>). </td></tr>
    <tr><td class="paramname">$batch</td><td>Optional parameters to pass into the batch API. </td></tr>
    <tr><td class="paramname">$redirect_callback</td><td>(optional) Specify a function to be called to redirect to the progressive processing page.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="update_8inc.html#aa931d6cdddc2e9e0ec96d240523056e9">update_resolve_dependencies()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="aafca47c65645d8463d85a3fa7884c220"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8inc.html#aafca47c65645d8463d85a3fa7884c220">update_build_dependency_graph</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>update_functions</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Constructs a graph which encodes the dependencies between module updates.</p>
<p>This function returns an associative array which contains a "directed graph" representation of the dependencies between a provided list of update functions, as well as any outside update functions that they directly depend on but that were not in the provided list. The vertices of the graph represent the update functions themselves, and each edge represents a requirement that the first update function needs to run before the second. For example, consider this graph:</p>
<p>system_update_7000 ---&gt; system_update_7001 ---&gt; system_update_7002</p>
<p>Visually, this indicates that system_update_7000() must run before system_update_7001(), which in turn must run before system_update_7002().</p>
<p>The function takes into account standard dependencies within each module, as shown above (i.e., the fact that each module's updates must run in numerical order), but also finds any cross-module dependencies that are defined by modules which implement <a class="el" href="group__hooks.html#ga23e9e019b7ec64d95bafbeaffd295483">hook_update_dependencies()</a>, and builds them into the graph as well.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$update_functions</td><td>An organized array of update functions, in the format returned by <a class="el" href="update_8inc.html#ad268e1662e1d06a85f3d51dfec9955b2">update_get_update_function_list()</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>A multidimensional array representing the dependency graph, suitable for passing in to <a class="el" href="graph_8inc.html#ab1e9257090d35212bd3dd3eba7706471">drupal_depth_first_search()</a>, but with extra information about each update function also included. Each array key contains the name of an update function, including all update functions from the provided list as well as any outside update functions which they directly depend on. Each value is an associative array containing the following keys:<ul>
<li>'edges': A representation of any other update functions that immediately depend on this one. See <a class="el" href="graph_8inc.html#ab1e9257090d35212bd3dd3eba7706471">drupal_depth_first_search()</a> for more details on the format.</li>
<li>'module': The name of the module that this update function belongs to.</li>
<li>'number': The number of this update function within that module.</li>
</ul>
</dd></dl>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="graph_8inc.html#ab1e9257090d35212bd3dd3eba7706471">drupal_depth_first_search()</a> </dd>
<dd>
<a class="el" href="update_8inc.html#aa931d6cdddc2e9e0ec96d240523056e9">update_resolve_dependencies()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a39592132a77fd791c44a8d6faf362cb0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8inc.html#a39592132a77fd791c44a8d6faf362cb0">update_check_incompatibility</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>type</em> = <code>'module'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Helper function to test compatibility of a module or theme. </p>

</div>
</div>
<a class="anchor" id="ac46854f64e50a81361ed8816b8f0ce7e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8inc.html#ac46854f64e50a81361ed8816b8f0ce7e">update_do_one</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>dependency_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Perform one update and store the results for display on finished page.</p>
<p>If an update function completes successfully, it should return a message as a string indicating success, for example: </p>
<div class="fragment"><pre class="fragment"> <span class="keywordflow">return</span> t(<span class="stringliteral">&#39;New index added successfully.&#39;</span>);
</pre></div><p>Alternatively, it may return nothing. In that case, no message will be displayed at all.</p>
<p>If it fails for whatever reason, it should throw an instance of <a class="el" href="class_drupal_update_exception.html">DrupalUpdateException</a> with an appropriate error message, for example: </p>
<div class="fragment"><pre class="fragment"> <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_drupal_update_exception.html">DrupalUpdateException</a>(t(<span class="stringliteral">&#39;Description of what went wrong&#39;</span>));
</pre></div><p>If an exception is thrown, the current update and all updates that depend on it will be aborted. The schema version will not be updated in this case, and all the aborted updates will continue to appear on <a class="el" href="update_8php.html">update.php</a> as updates that have not yet been run.</p>
<p>If an update function needs to be re-run as part of a batch process, it should accept the $sandbox array by reference as its first parameter and set the #finished property to the percentage completed that it is, as a fraction of 1.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$module</td><td>The module whose update will be run. </td></tr>
    <tr><td class="paramname">$number</td><td>The update number to run. </td></tr>
    <tr><td class="paramname">$dependency_map</td><td>An array whose keys are the names of all update functions that will be performed during this batch process, and whose values are arrays of other update functions that each one depends on. </td></tr>
    <tr><td class="paramname">$context</td><td>The batch context array.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="update_8inc.html#aa931d6cdddc2e9e0ec96d240523056e9">update_resolve_dependencies()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a80f7fdd8ca66ebda4959b9429fc343f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8inc.html#a80f7fdd8ca66ebda4959b9429fc343f3">update_finished</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>success</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>results</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>operations</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Finish the update process and store results for eventual display.</p>
<p>After the updates run, all caches are flushed. The update results are stored into the session (for example, to be displayed on the update results page in <a class="el" href="update_8php.html">update.php</a>). Additionally, if the site was off-line, now that the update process is completed, the site is set back online.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$success</td><td>Indicate that the batch API tasks were all completed successfully. </td></tr>
    <tr><td class="paramname">$results</td><td>An array of all the results that were updated in <a class="el" href="update_8inc.html#ac46854f64e50a81361ed8816b8f0ce7e">update_do_one()</a>. </td></tr>
    <tr><td class="paramname">$operations</td><td>A list of all the operations that had not been completed by the batch API.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="update_8inc.html#aa4dd3d84e553f6bf25ad19608152d5b7">update_batch()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ab86cb0f00b89fc52f7f6294be9a1e33c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8inc.html#ab86cb0f00b89fc52f7f6294be9a1e33c">update_fix_compatibility</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Disable any items in the {system} table that are not core compatible. </p>

</div>
</div>
<a class="anchor" id="a349ad25ac5547fbb44556538758988a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8inc.html#a349ad25ac5547fbb44556538758988a2">update_fix_d7_block_deltas</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>sandbox</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>renamed_deltas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>moved_deltas</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>A helper function that modules can use to assist with the transformation from numeric block deltas to string block deltas during the 6.x -&gt; 7.x upgrade.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000008">Todo:</a></b></dt><dd>This function should be removed in 8.x.</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$sandbox</td><td>An array holding data for the batch process. </td></tr>
    <tr><td class="paramname">$renamed_deltas</td><td>An associative array. Keys are module names, values an associative array mapping the old block deltas to the new block deltas for the module. Example: <div class="fragment"><pre class="fragment">     $renamed_deltas = array(
       <span class="stringliteral">&#39;mymodule&#39;</span> =&gt;
         array(
           0 =&gt; <span class="stringliteral">&#39;mymodule-block-1&#39;</span>,
           1 =&gt; <span class="stringliteral">&#39;mymodule-block-2&#39;</span>,
         ),
     );
</pre></div> </td></tr>
    <tr><td class="paramname">$moved_deltas</td><td>An associative array. Keys are source module names, values an associative array mapping the (possibly renamed) block name to the new module name. Example: <div class="fragment"><pre class="fragment">     $moved_deltas = array(
       <span class="stringliteral">&#39;user&#39;</span> =&gt;
         array(
           <span class="stringliteral">&#39;navigation&#39;</span> =&gt; <span class="stringliteral">&#39;system&#39;</span>,
         ),
     );
</pre></div> </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a4c65cc44fc9d615c6f69ac8ecb57bf5a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8inc.html#a4c65cc44fc9d615c6f69ac8ecb57bf5a">update_fix_d7_install_profile</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Register the currently installed profile in the system table.</p>
<p>Install profiles are now treated as modules by Drupal, and have an upgrade path based on their schema version in the system table.</p>
<p>The install profile will be set to schema_version 0, as it has already been installed. Any other hook_update_N functions provided by the install profile will be run by <a class="el" href="update_8php.html">update.php</a>. </p>

</div>
</div>
<a class="anchor" id="a00697f7fb179855f3c3fa65105abee94"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8inc.html#a00697f7fb179855f3c3fa65105abee94">update_fix_d7_requirements</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Perform Drupal 6.x to 7.x updates that are required for <a class="el" href="update_8php.html">update.php</a> to function properly.</p>
<p>This function runs when <a class="el" href="update_8php.html">update.php</a> is run the first time for 7.x, even before updates are selected or performed. It is important that if updates are not ultimately performed that no changes are made which make it impossible to continue using the prior version. </p>

</div>
</div>
<a class="anchor" id="a1e41248922d100f2412b8471c05c59be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8inc.html#a1e41248922d100f2412b8471c05c59be">update_get_d6_session_name</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Constructs a session name compatible with a D6 environment.</p>
<dl class="section return"><dt>Returns:</dt><dd>D6-compatible session name string.</dd></dl>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="bootstrap_8inc.html#acae9a8501a2571219d7517f50cc6afec">drupal_settings_initialize()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ad268e1662e1d06a85f3d51dfec9955b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8inc.html#ad268e1662e1d06a85f3d51dfec9955b2">update_get_update_function_list</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>starting_updates</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns an organized list of update functions for a set of modules.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$starting_updates</td><td>An array whose keys contain the names of modules and whose values contain the number of the first requested update for that module.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>An array containing all the update functions that should be run for each module, including the provided starting update and all subsequent updates that are available. The keys of the array contain the module names, and each value is an ordered array of update functions, keyed by the update number.</dd></dl>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="update_8inc.html#aa931d6cdddc2e9e0ec96d240523056e9">update_resolve_dependencies()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ae95fb5ec58e85fd5c10c56345fd7cabe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8inc.html#ae95fb5ec58e85fd5c10c56345fd7cabe">update_get_update_list</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return a list of all the pending database updates.</p>
<dl class="section return"><dt>Returns:</dt><dd>An associative array keyed by module name which contains all information about database updates that need to be run, and any updates that are not going to proceed due to missing requirements. The system module will always be listed first.</dd></dl>
<p>The subarray for each module can contain the following keys:</p>
<ul>
<li>start: The starting update that is to be processed. If this does not exist then do not process any updates for this module as there are other requirements that need to be resolved.</li>
<li>warning: Any warnings about why this module can not be updated.</li>
<li>pending: An array of all the pending updates for the module including the update number and the description from source code comment for each update function. This array is keyed by the update number. </li>
</ul>

</div>
</div>
<a class="anchor" id="ab41c0d635b6a220d269146f778a6a245"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8inc.html#ab41c0d635b6a220d269146f778a6a245">update_is_missing</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>update_functions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Determines if a module update is missing or unavailable.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$module</td><td>The name of the module. </td></tr>
    <tr><td class="paramname">$number</td><td>The number of the update within that module. </td></tr>
    <tr><td class="paramname">$update_functions</td><td>An organized array of update functions, in the format returned by <a class="el" href="update_8inc.html#ad268e1662e1d06a85f3d51dfec9955b2">update_get_update_function_list()</a>. This should represent all module updates that are requested to run at the time this function is called.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>TRUE if the provided module update is not installed or is not in the provided list of updates to run; FALSE otherwise. </dd></dl>

</div>
</div>
<a class="anchor" id="a39f4938dea0ce704d1e426243cec11ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8inc.html#a39f4938dea0ce704d1e426243cec11ec">update_parse_db_url</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>db_url</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>db_prefix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Parse pre-Drupal 7 database connection URLs and return D7 compatible array.</p>
<dl class="section return"><dt>Returns:</dt><dd>Drupal 7 DBTNG compatible array of database connection information. </dd></dl>

</div>
</div>
<a class="anchor" id="ae3ce2c866dce2d33c363b57136a2ba84"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8inc.html#ae3ce2c866dce2d33c363b57136a2ba84">update_prepare_d7_bootstrap</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Performs extra steps required to bootstrap when using a Drupal 6 database.</p>
<p>Users who still have a Drupal 6 database (and are in the process of updating to Drupal 7) need extra help before a full bootstrap can be achieved. This function does the necessary preliminary work that allows the bootstrap to be successful.</p>
<p>No access check has been performed when this function is called, so no irreversible changes to the database are made here. </p>

</div>
</div>
<a class="anchor" id="aa931d6cdddc2e9e0ec96d240523056e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8inc.html#aa931d6cdddc2e9e0ec96d240523056e9">update_resolve_dependencies</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>starting_updates</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Resolves dependencies in a set of module updates, and orders them correctly.</p>
<p>This function receives a list of requested module updates and determines an appropriate order to run them in such that all update dependencies are met. Any updates whose dependencies cannot be met are included in the returned array but have the key 'allowed' set to FALSE; the calling function should take responsibility for ensuring that these updates are ultimately not performed.</p>
<p>In addition, the returned array also includes detailed information about the dependency chain for each update, as provided by the depth-first search algorithm in <a class="el" href="graph_8inc.html#ab1e9257090d35212bd3dd3eba7706471">drupal_depth_first_search()</a>.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$starting_updates</td><td>An array whose keys contain the names of modules with updates to be run and whose values contain the number of the first requested update for that module.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>An array whose keys are the names of all update functions within the provided modules that would need to be run in order to fulfill the request, arranged in the order in which the update functions should be run. (This includes the provided starting update for each module and all subsequent updates that are available.) The values are themselves arrays containing all the keys provided by the <a class="el" href="graph_8inc.html#ab1e9257090d35212bd3dd3eba7706471">drupal_depth_first_search()</a> algorithm, which encode detailed information about the dependency chain for this update function (for example: 'paths', 'reverse_paths', 'weight', and 'component'), as well as the following additional keys:<ul>
<li>'allowed': A boolean which is TRUE when the update function's dependencies are met, and FALSE otherwise. Calling functions should inspect this value before running the update.</li>
<li>'missing_dependencies': An array containing the names of any other update functions that are required by this one but that are unavailable to be run. This array will be empty when 'allowed' is TRUE.</li>
<li>'module': The name of the module that this update function belongs to.</li>
<li>'number': The number of this update function within that module.</li>
</ul>
</dd></dl>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="graph_8inc.html#ab1e9257090d35212bd3dd3eba7706471">drupal_depth_first_search()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="af82e7fa9b13df713eb110a4e782b0e69"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8inc.html#af82e7fa9b13df713eb110a4e782b0e69">update_retrieve_dependencies</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Invoke <a class="el" href="group__hooks.html#ga23e9e019b7ec64d95bafbeaffd295483">hook_update_dependencies()</a> in all installed modules.</p>
<p>This function is similar to <a class="el" href="group__hooks.html#gabedb5f566ef5faaa5768dd15125b111c">module_invoke_all()</a>, with the main difference that it does not require that a module be enabled to invoke its hook, only that it be installed. This allows the update system to properly perform updates even on modules that are currently disabled.</p>
<dl class="section return"><dt>Returns:</dt><dd>An array of return values obtained by merging the results of the <a class="el" href="group__hooks.html#ga23e9e019b7ec64d95bafbeaffd295483">hook_update_dependencies()</a> implementations in all installed modules.</dd></dl>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="group__hooks.html#gabedb5f566ef5faaa5768dd15125b111c">module_invoke_all()</a> </dd>
<dd>
<a class="el" href="group__hooks.html#ga23e9e019b7ec64d95bafbeaffd295483">hook_update_dependencies()</a> </dd></dl>

</div>
</div>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Sun May 13 2012 05:35:55 for Drupal by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.0
</small></address>

</body>
</html>
