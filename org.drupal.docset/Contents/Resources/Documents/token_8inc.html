<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Drupal: includes/token.inc File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Drupal
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">includes/token.inc File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a47eb294b05ca8d04439a9a82ccc4d82a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="token_8inc.html#a47eb294b05ca8d04439a9a82ccc4d82a">token_replace</a> ($text, array $data=array(), array $options=array())</td></tr>
<tr class="memitem:a0672a1031161b81dd5aff4476bbc1c99"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="token_8inc.html#a0672a1031161b81dd5aff4476bbc1c99">token_scan</a> ($text)</td></tr>
<tr class="memitem:abcd5ba5a75b47fe97338243a62d4eecd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="token_8inc.html#abcd5ba5a75b47fe97338243a62d4eecd">token_generate</a> ($type, array $tokens, array $data=array(), array $options=array())</td></tr>
<tr class="memitem:ae6241ad02cf636533b0a8304d2df4c1b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="token_8inc.html#ae6241ad02cf636533b0a8304d2df4c1b">token_find_with_prefix</a> (array $tokens, $prefix, $delimiter= ':')</td></tr>
<tr class="memitem:a24f0543f20ed0c8b807a680e67248704"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="token_8inc.html#a24f0543f20ed0c8b807a680e67248704">token_info</a> ()</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Drupal placeholder/token replacement system.</p>
<p>API functions for replacing placeholders in text with meaningful values.</p>
<p>For example: When configuring automated emails, an administrator enters standard text for the email. Variables like the title of a node and the date the email was sent can be entered as placeholders like [node:title] and [date:short]. When a Drupal module prepares to send the email, it can call the <a class="el" href="token_8inc.html#a47eb294b05ca8d04439a9a82ccc4d82a">token_replace()</a> function, passing in the text. The token system will scan the text for placeholder tokens, give other modules an opportunity to replace them with meaningful text, then return the final product to the original module.</p>
<p>Tokens follow the form: [$type:$name], where $type is a general class of tokens like 'node', 'user', or 'comment' and $name is the name of a given placeholder. For example, [node:title] or [node:created:since].</p>
<p>In addition to raw text containing placeholders, modules may pass in an array of objects to be used when performing the replacement. The objects should be keyed by the token type they correspond to. For example:</p>
<div class="fragment"><pre class="fragment"> <span class="comment">// Load a node and a user, then replace tokens in the text.</span>
 $text = <span class="stringliteral">&#39;On [date:short], [user:name] read [node:title].&#39;</span>;
 $node = node_load(1);
 $user = user_load(1);

 <span class="comment">// [date:...] tokens use the current date automatically.</span>
 $data = array(<span class="stringliteral">&#39;node&#39;</span> =&gt; $node, <span class="stringliteral">&#39;user&#39;</span> =&gt; $user);
 <span class="keywordflow">return</span> <a class="code" href="token_8inc.html#a47eb294b05ca8d04439a9a82ccc4d82a">token_replace</a>($text, $data);
</pre></div><p>Some tokens may be chained in the form of [$type:$pointer:$name], where $type is a normal token type, $pointer is a reference to another token type, and $name is the name of a given placeholder. For example, [node:author:mail]. In that example, 'author' is a pointer to the 'user' account that created the node, and 'mail' is a placeholder available for any 'user'.</p>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="token_8inc.html#a47eb294b05ca8d04439a9a82ccc4d82a">token_replace()</a> </dd>
<dd>
<a class="el" href="group__hooks.html#ga3bfd87d9a19b2397b0f970e1cff7ea4f">hook_tokens()</a> </dd>
<dd>
<a class="el" href="group__hooks.html#gab868597197cf36911f95dcd29ae0b954">hook_token_info()</a> </dd></dl>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="ae6241ad02cf636533b0a8304d2df4c1b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="token_8inc.html#ae6241ad02cf636533b0a8304d2df4c1b">token_find_with_prefix</a> </td>
          <td>(</td>
          <td class="paramtype">array $&#160;</td>
          <td class="paramname"><em>tokens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>prefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>delimiter</em> = <code>':'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Given a list of tokens, returns those that begin with a specific prefix.</p>
<p>Used to extract a group of 'chained' tokens (such as [node:author:name]) from the full list of tokens found in text. For example: </p>
<div class="fragment"><pre class="fragment">   $data = array(
     <span class="stringliteral">&#39;author:name&#39;</span> =&gt; <span class="stringliteral">&#39;[node:author:name]&#39;</span>,
     <span class="stringliteral">&#39;title&#39;</span>       =&gt; <span class="stringliteral">&#39;[node:title]&#39;</span>,
     <span class="stringliteral">&#39;created&#39;</span>     =&gt; <span class="stringliteral">&#39;[node:created]&#39;</span>,
   );
   $results = <a class="code" href="token_8inc.html#ae6241ad02cf636533b0a8304d2df4c1b">token_find_with_prefix</a>($data, <span class="stringliteral">&#39;author&#39;</span>);
   $results == array(<span class="stringliteral">&#39;name&#39;</span> =&gt; <span class="stringliteral">&#39;[node:author:name]&#39;</span>);
</pre></div><dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$tokens</td><td>A keyed array of tokens, and their original raw form in the source text. </td></tr>
    <tr><td class="paramname">$prefix</td><td>A textual string to be matched at the beginning of the token. </td></tr>
    <tr><td class="paramname">$delimiter</td><td>An optional string containing the character that separates the prefix from the rest of the token. Defaults to ':'.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>An associative array of discovered tokens, with the prefix and delimiter stripped from the key. </dd></dl>

</div>
</div>
<a class="anchor" id="abcd5ba5a75b47fe97338243a62d4eecd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="token_8inc.html#abcd5ba5a75b47fe97338243a62d4eecd">token_generate</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array $&#160;</td>
          <td class="paramname"><em>tokens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array $&#160;</td>
          <td class="paramname"><em>data</em> = <code>array()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array $&#160;</td>
          <td class="paramname"><em>options</em> = <code>array()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Generates replacement values for a list of tokens.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$type</td><td>The type of token being replaced. 'node', 'user', and 'date' are common. </td></tr>
    <tr><td class="paramname">$tokens</td><td>An array of tokens to be replaced, keyed by the literal text of the token as it appeared in the source text. </td></tr>
    <tr><td class="paramname">$data</td><td>(optional) An array of keyed objects. For simple replacement scenarios 'node', 'user', and others are common keys, with an accompanying node or user object being the value. Some token types, like 'site', do not require any explicit information from $data and can be replaced even if it is empty. </td></tr>
    <tr><td class="paramname">$options</td><td>(optional) A keyed array of settings and flags to control the token replacement process. Supported options are:<ul>
<li>language: A language object to be used when generating locale-sensitive tokens.</li>
<li>callback: A callback function that will be used to post-process the array of token replacements after they are generated. Can be used when modules require special formatting of token text, for example URL encoding or truncation to a specific length.</li>
<li>sanitize: A boolean flag indicating that tokens should be sanitized for display to a web browser. Developers who set this option to FALSE assume responsibility for running <a class="el" href="group__sanitization.html#ga8864a29ffa8de5c9f8dc9e417060660d">filter_xss()</a>, <a class="el" href="group__sanitization.html#ga76fc67a30fd8d75ddd80565e6e65a13d">check_plain()</a> or other appropriate scrubbing functions before displaying data to users.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>An associative array of replacement values, keyed by the original 'raw' tokens that were found in the source text. For example: $results['[node:title]'] = 'My new node';</dd></dl>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="group__hooks.html#ga3bfd87d9a19b2397b0f970e1cff7ea4f">hook_tokens()</a> </dd>
<dd>
<a class="el" href="group__hooks.html#gaeeea438e74b29e5603f0ed3f1967a257">hook_tokens_alter()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a24f0543f20ed0c8b807a680e67248704"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="token_8inc.html#a24f0543f20ed0c8b807a680e67248704">token_info</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns metadata describing supported tokens.</p>
<p>The metadata array contains token type, name, and description data as well as an optional pointer indicating that the token chains to another set of tokens. For example: </p>
<div class="fragment"><pre class="fragment">   $data[<span class="stringliteral">&#39;types&#39;</span>][<span class="stringliteral">&#39;node&#39;</span>] = array(
     <span class="stringliteral">&#39;name&#39;</span> =&gt; t(<span class="stringliteral">&#39;Nodes&#39;</span>),
     <span class="stringliteral">&#39;description&#39;</span> =&gt; t(<span class="stringliteral">&#39;Tokens related to node objects.&#39;</span>),
   );
   $data[<span class="stringliteral">&#39;tokens&#39;</span>][<span class="stringliteral">&#39;node&#39;</span>][<span class="stringliteral">&#39;title&#39;</span>] = array(
     <span class="stringliteral">&#39;name&#39;</span> =&gt; t(<span class="stringliteral">&#39;Title&#39;</span>),
     <span class="stringliteral">&#39;description&#39;</span> =&gt; t(<span class="stringliteral">&#39;The title of the current node.&#39;</span>),
   );
   $data[<span class="stringliteral">&#39;tokens&#39;</span>][<span class="stringliteral">&#39;node&#39;</span>][<span class="stringliteral">&#39;author&#39;</span>] = array(
     <span class="stringliteral">&#39;name&#39;</span> =&gt; t(<span class="stringliteral">&#39;Author&#39;</span>),
     <span class="stringliteral">&#39;description&#39;</span> =&gt; t(<span class="stringliteral">&#39;The author of the current node.&#39;</span>),
     <span class="stringliteral">&#39;type&#39;</span> =&gt; <span class="stringliteral">&#39;user&#39;</span>,
   );
</pre></div><dl class="section return"><dt>Returns:</dt><dd>An associative array of token information, grouped by token type. </dd></dl>

</div>
</div>
<a class="anchor" id="a47eb294b05ca8d04439a9a82ccc4d82a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="token_8inc.html#a47eb294b05ca8d04439a9a82ccc4d82a">token_replace</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array $&#160;</td>
          <td class="paramname"><em>data</em> = <code>array()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array $&#160;</td>
          <td class="paramname"><em>options</em> = <code>array()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Replaces all tokens in a given string with appropriate values.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$text</td><td>A string potentially containing replaceable tokens. </td></tr>
    <tr><td class="paramname">$data</td><td>(optional) An array of keyed objects. For simple replacement scenarios 'node', 'user', and others are common keys, with an accompanying node or user object being the value. Some token types, like 'site', do not require any explicit information from $data and can be replaced even if it is empty. </td></tr>
    <tr><td class="paramname">$options</td><td>(optional) A keyed array of settings and flags to control the token replacement process. Supported options are:<ul>
<li>language: A language object to be used when generating locale-sensitive tokens.</li>
<li>callback: A callback function that will be used to post-process the array of token replacements after they are generated. For example, a module using tokens in a text-only email might provide a callback to strip HTML entities from token values before they are inserted into the final text.</li>
<li>clear: A boolean flag indicating that tokens should be removed from the final text if no replacement value can be generated.</li>
<li>sanitize: A boolean flag indicating that tokens should be sanitized for display to a web browser. Defaults to TRUE. Developers who set this option to FALSE assume responsibility for running <a class="el" href="group__sanitization.html#ga8864a29ffa8de5c9f8dc9e417060660d">filter_xss()</a>, <a class="el" href="group__sanitization.html#ga76fc67a30fd8d75ddd80565e6e65a13d">check_plain()</a> or other appropriate scrubbing functions before displaying data to users.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>Text with tokens replaced. </dd></dl>

</div>
</div>
<a class="anchor" id="a0672a1031161b81dd5aff4476bbc1c99"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="token_8inc.html#a0672a1031161b81dd5aff4476bbc1c99">token_scan</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>text</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Builds a list of all token-like patterns that appear in the text.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$text</td><td>The text to be scanned for possible tokens.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>An associative array of discovered tokens, grouped by type. </dd></dl>

</div>
</div>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Sun May 13 2012 05:35:54 for Drupal by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.0
</small></address>

</body>
</html>
