<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Drupal: modules/update/update.fetch.inc File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Drupal
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">modules/update/update.fetch.inc File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acb92114e3c9f719e50f66ac62ff78e01"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8fetch_8inc.html#acb92114e3c9f719e50f66ac62ff78e01">update_manual_status</a> ()</td></tr>
<tr class="memitem:a7975896014a8fc9b4e14306a875b97f2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8fetch_8inc.html#a7975896014a8fc9b4e14306a875b97f2">update_fetch_data_batch</a> (&amp;$context)</td></tr>
<tr class="memitem:ac901625f220862b797fb5c5cc4dcb654"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8fetch_8inc.html#ac901625f220862b797fb5c5cc4dcb654">update_fetch_data_finished</a> ($success, $results)</td></tr>
<tr class="memitem:a3a3122bc6fdfe23091d8db56e4430aeb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8fetch_8inc.html#a3a3122bc6fdfe23091d8db56e4430aeb">_update_fetch_data</a> ()</td></tr>
<tr class="memitem:a49b627a7dcb3c714f088bc0e7ef40e85"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8fetch_8inc.html#a49b627a7dcb3c714f088bc0e7ef40e85">_update_process_fetch_task</a> ($project)</td></tr>
<tr class="memitem:aa9814236d331f2e6822435215e9acd8e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8fetch_8inc.html#aa9814236d331f2e6822435215e9acd8e">_update_refresh</a> ()</td></tr>
<tr class="memitem:a8b22762aaa27e7a0927f4f3ad09ad5e1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8fetch_8inc.html#a8b22762aaa27e7a0927f4f3ad09ad5e1">_update_create_fetch_task</a> ($project)</td></tr>
<tr class="memitem:a6d937d41a6ccf645109deefae0f6e5d3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8fetch_8inc.html#a6d937d41a6ccf645109deefae0f6e5d3">_update_build_fetch_url</a> ($project, $site_key= '')</td></tr>
<tr class="memitem:a53552af8849428ac6faba273936eb00a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8fetch_8inc.html#a53552af8849428ac6faba273936eb00a">_update_get_fetch_url_base</a> ($project)</td></tr>
<tr class="memitem:a55d78e25faf69f49cfc88f2642c06f4e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8fetch_8inc.html#a55d78e25faf69f49cfc88f2642c06f4e">_update_cron_notify</a> ()</td></tr>
<tr class="memitem:a3d8f5a924c1de0728c829d3c92d60d19"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8fetch_8inc.html#a3d8f5a924c1de0728c829d3c92d60d19">update_parse_xml</a> ($raw_xml)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Code required only when fetching information about available updates. </p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="a6d937d41a6ccf645109deefae0f6e5d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8fetch_8inc.html#a6d937d41a6ccf645109deefae0f6e5d3">_update_build_fetch_url</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>site_key</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Generates the URL to fetch information about project updates.</p>
<p>This figures out the right URL to use, based on the project's .info file and the global defaults. Appends optional query arguments when the site is configured to report usage stats.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$project</td><td>The array of project information from <a class="el" href="update_8compare_8inc.html#a7e1ea49d91f2d2b81b8101d481d10300">update_get_projects()</a>. </td></tr>
    <tr><td class="paramname">$site_key</td><td>The anonymous site key hash (optional).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also:</dt><dd>update_fetch_data() </dd>
<dd>
<a class="el" href="update_8fetch_8inc.html#a49b627a7dcb3c714f088bc0e7ef40e85">_update_process_fetch_task()</a> </dd>
<dd>
<a class="el" href="update_8compare_8inc.html#a7e1ea49d91f2d2b81b8101d481d10300">update_get_projects()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a8b22762aaa27e7a0927f4f3ad09ad5e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8fetch_8inc.html#a8b22762aaa27e7a0927f4f3ad09ad5e1">_update_create_fetch_task</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>project</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Add a task to the queue for fetching release history data for a project.</p>
<p>We only create a new fetch task if there's no task already in the queue for this particular project (based on 'fetch_task::' entries in the {cache_update} table).</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$project</td><td>Associative array of information about a project as created by <a class="el" href="update_8compare_8inc.html#a7e1ea49d91f2d2b81b8101d481d10300">update_get_projects()</a>, including keys such as 'name' (short name), and the 'info' array with data from a .info file for the project.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="update_8compare_8inc.html#a7e1ea49d91f2d2b81b8101d481d10300">update_get_projects()</a> </dd>
<dd>
update_get_available() </dd>
<dd>
update_refresh() </dd>
<dd>
update_fetch_data() </dd>
<dd>
<a class="el" href="update_8fetch_8inc.html#a49b627a7dcb3c714f088bc0e7ef40e85">_update_process_fetch_task()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a55d78e25faf69f49cfc88f2642c06f4e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8fetch_8inc.html#a55d78e25faf69f49cfc88f2642c06f4e">_update_cron_notify</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Perform any notifications that should be done once cron fetches new data.</p>
<p>This method checks the status of the site using the new data and depending on the configuration of the site, notifies administrators via email if there are new releases or missing security updates.</p>
<dl class="section see"><dt>See also:</dt><dd>update_requirements() </dd></dl>

</div>
</div>
<a class="anchor" id="a3a3122bc6fdfe23091d8db56e4430aeb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8fetch_8inc.html#a3a3122bc6fdfe23091d8db56e4430aeb">_update_fetch_data</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Attempt to drain the queue of tasks for release history data to fetch. </p>

</div>
</div>
<a class="anchor" id="a53552af8849428ac6faba273936eb00a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8fetch_8inc.html#a53552af8849428ac6faba273936eb00a">_update_get_fetch_url_base</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>project</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return the base of the URL to fetch available update data for a project.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$project</td><td>The array of project information from <a class="el" href="update_8compare_8inc.html#a7e1ea49d91f2d2b81b8101d481d10300">update_get_projects()</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>The base of the URL used for fetching available update data. This does not include the path elements to specify a particular project, version, site_key, etc.</dd></dl>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="update_8fetch_8inc.html#a6d937d41a6ccf645109deefae0f6e5d3">_update_build_fetch_url()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a49b627a7dcb3c714f088bc0e7ef40e85"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8fetch_8inc.html#a49b627a7dcb3c714f088bc0e7ef40e85">_update_process_fetch_task</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>project</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Process a task to fetch available update data for a single project.</p>
<p>Once the release history XML data is downloaded, it is parsed and saved into the {cache_update} table in an entry just for that project.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$project</td><td>Associative array of information about the project to fetch data for. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>TRUE if we fetched parsable XML, otherwise FALSE. </dd></dl>

</div>
</div>
<a class="anchor" id="aa9814236d331f2e6822435215e9acd8e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8fetch_8inc.html#aa9814236d331f2e6822435215e9acd8e">_update_refresh</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Clear out all the cached available update data and initiate re-fetching. </p>

</div>
</div>
<a class="anchor" id="a7975896014a8fc9b4e14306a875b97f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8fetch_8inc.html#a7975896014a8fc9b4e14306a875b97f2">update_fetch_data_batch</a> </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Process a step in the batch for fetching available update data. </p>

</div>
</div>
<a class="anchor" id="ac901625f220862b797fb5c5cc4dcb654"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8fetch_8inc.html#ac901625f220862b797fb5c5cc4dcb654">update_fetch_data_finished</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>success</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>results</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Batch API callback when all fetch tasks have been completed.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$success</td><td>Boolean indicating the success of the batch. </td></tr>
    <tr><td class="paramname">$results</td><td>Associative array holding the results of the batch, including the key 'updated' which holds the total number of projects we fetched available update data for. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="acb92114e3c9f719e50f66ac62ff78e01"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8fetch_8inc.html#acb92114e3c9f719e50f66ac62ff78e01">update_manual_status</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Callback to manually check the update status without cron. </p>

</div>
</div>
<a class="anchor" id="a3d8f5a924c1de0728c829d3c92d60d19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="update_8fetch_8inc.html#a3d8f5a924c1de0728c829d3c92d60d19">update_parse_xml</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>raw_xml</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Parse the XML of the Drupal release history info files.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$raw_xml</td><td>A raw XML string of available release data for a given project.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>Array of parsed data about releases for a given project, or NULL if there was an error parsing the string. </dd></dl>

</div>
</div>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Sun May 13 2012 05:35:55 for Drupal by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.0
</small></address>

</body>
</html>
