<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Drupal: Sanitization functions</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Drupal
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Sanitization functions</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga46ff2822d576a77317f9045d65317b4f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sanitization.html#ga46ff2822d576a77317f9045d65317b4f">drupal_strip_dangerous_protocols</a> ($uri)</td></tr>
<tr class="memitem:gac024315b69035ef05c33674838707919"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sanitization.html#gac024315b69035ef05c33674838707919">check_url</a> ($uri)</td></tr>
<tr class="memitem:ga97dcceb77b76539219af2a85eacbe18d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sanitization.html#ga97dcceb77b76539219af2a85eacbe18d">filter_xss_admin</a> ($string)</td></tr>
<tr class="memitem:ga8864a29ffa8de5c9f8dc9e417060660d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sanitization.html#ga8864a29ffa8de5c9f8dc9e417060660d">filter_xss</a> ($string, $allowed_tags=array('a', 'em', 'strong', 'cite', 'blockquote', 'code', 'ul', 'ol', 'li', 'dl', 'dt', 'dd'))</td></tr>
<tr class="memitem:ga1cc6cca885f021adcf11970b8ec4c846"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sanitization.html#ga1cc6cca885f021adcf11970b8ec4c846">_filter_xss_split</a> ($m, $store=FALSE)</td></tr>
<tr class="memitem:ga3c24df8bdf07aa972dd82aa2ab35858f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sanitization.html#ga3c24df8bdf07aa972dd82aa2ab35858f">_filter_xss_attributes</a> ($attr)</td></tr>
<tr class="memitem:ga81affabdadf9d999874d5a69316ec8c8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sanitization.html#ga81affabdadf9d999874d5a69316ec8c8">filter_xss_bad_protocol</a> ($string, $decode=TRUE)</td></tr>
<tr class="memitem:gacf11629fb3d1ebf200863e2d15380b4a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sanitization.html#gacf11629fb3d1ebf200863e2d15380b4a">drupal_attributes</a> (array $attributes=array())</td></tr>
<tr class="memitem:gabc78d1b88aa8081093abbbf71a516c7c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sanitization.html#gabc78d1b88aa8081093abbbf71a516c7c">st</a> ($string, array $args=array(), array $options=array())</td></tr>
<tr><td colspan="2"><h2><a name="member-group"></a>
into your string, and t() will</h2></td></tr>
<tr><td class="ititle" colspan="2"><p><a class="anchor" id="amgrpc24520cd0c9d113d5113bfec581ba6b9"></a> Translates a string to the current language or to a given language.</p>
<p>The t() function serves two purposes. First, at run-time it translates user-visible text into the appropriate language. Second, various mechanisms that figure out what text needs to be translated work off t() -- the text inside t() calls is added to the database of strings to be translated. These strings are expected to be in English, so the first argument should always be in English. To enable a fully-translatable site, it is important that all human-readable text that will be displayed on the site or sent to a user is passed through the t() function, or a related function. See the <a class="el" href="">Localization API </a> pages for more information, including recommendations on how to break up or not break up strings for translation.</p>
<p>You should never use t() to translate variables, such as calling </p>
<div class="fragment"><pre class="fragment"> t($text); 
</pre></div><p>, unless the text that the variable holds has been passed through t() elsewhere (e.g., $text is one of several translated literal strings in an array). It is especially important never to call </p>
<div class="fragment"><pre class="fragment"> t($user_text); 
</pre></div><p>, where $user_text is some text that a user entered - doing that can lead to cross-site scripting and other security problems. However, you can use variable substitution in your string, to put variable text such as user names or link URLs into translated text. Variable substitution looks like this: </p>
<div class="fragment"><pre class="fragment"> $text = t(<span class="stringliteral">&quot;@name&#39;s blog&quot;</span>, array(<span class="stringliteral">&#39;@name&#39;</span> =&gt; <a class="code" href="group__format.html#ga7124a026ecfacc51c57a75fcc083f136">format_username</a>($account)));
</pre></div><p> Basically, you can put variables like substitute their sanitized values at translation time. (See the Localization API pages referenced above and the documentation of <a class="el" href="group__sanitization.html#ga8da272cf93fb6ba229eca7c0b06ea4d2">format_string()</a> for details.) Translators can then rearrange the string as necessary for the language (e.g., in Spanish, it might be "blog de @name").</p>
<p>During the Drupal installation phase, some resources used by t() wil not be available to code that needs localization. See <a class="el" href="group__sanitization.html#gabc78d1b88aa8081093abbbf71a516c7c">st()</a> and <a class="el" href="group__sanitization.html#gaa50232f577883a48731fc93530628a79">get_t()</a> for alternatives.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$string</td><td>A string containing the English string to translate. </td></tr>
    <tr><td class="paramname">$args</td><td>An associative array of replacements to make after translation. Based on the first character of the key, the value is escaped and/or themed. See <a class="el" href="group__sanitization.html#ga8da272cf93fb6ba229eca7c0b06ea4d2">format_string()</a> for details. </td></tr>
    <tr><td class="paramname">$options</td><td>An associative array of additional options, with the following elements:<ul>
<li>'langcode' (defaults to the current language): The language code to translate to a language other than what is used to display the page.</li>
<li>'context' (defaults to the empty context): The context the source string belongs to.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>The translated string.</dd></dl>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="group__sanitization.html#gabc78d1b88aa8081093abbbf71a516c7c">st()</a> </dd>
<dd>
<a class="el" href="group__sanitization.html#gaa50232f577883a48731fc93530628a79">get_t()</a> </dd>
<dd>
<a class="el" href="group__sanitization.html#ga8da272cf93fb6ba229eca7c0b06ea4d2">format_string()</a> </dd></dl>
</td></tr>
<tr class="memitem:ga8da272cf93fb6ba229eca7c0b06ea4d2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sanitization.html#ga8da272cf93fb6ba229eca7c0b06ea4d2">format_string</a> ($string, array $args=array())</td></tr>
<tr class="memitem:ga76fc67a30fd8d75ddd80565e6e65a13d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sanitization.html#ga76fc67a30fd8d75ddd80565e6e65a13d">check_plain</a> ($text)</td></tr>
<tr class="memitem:gaa50232f577883a48731fc93530628a79"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sanitization.html#gaa50232f577883a48731fc93530628a79">get_t</a> ()</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<p>Functions to sanitize values.</p>
<p>See <a href="http://drupal.org/writing-secure-code">http://drupal.org/writing-secure-code</a> for information on writing secure code. </p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga3c24df8bdf07aa972dd82aa2ab35858f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__sanitization.html#ga3c24df8bdf07aa972dd82aa2ab35858f">_filter_xss_attributes</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>attr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Processes a string of HTML attributes.</p>
<dl class="section return"><dt>Returns:</dt><dd>Cleaned up version of the HTML attributes. </dd></dl>

</div>
</div>
<a class="anchor" id="ga1cc6cca885f021adcf11970b8ec4c846"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__sanitization.html#ga1cc6cca885f021adcf11970b8ec4c846">_filter_xss_split</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>store</em> = <code>FALSE</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Processes an HTML tag.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$m</td><td>An array with various meaning depending on the value of $store. If $store is TRUE then the array contains the allowed tags. If $store is FALSE then the array has one element, the HTML tag to process. </td></tr>
    <tr><td class="paramname">$store</td><td>Whether to store $m.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>If the element isn't allowed, an empty string. Otherwise, the cleaned up version of the HTML element. </dd></dl>

</div>
</div>
<a class="anchor" id="ga76fc67a30fd8d75ddd80565e6e65a13d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__sanitization.html#ga76fc67a30fd8d75ddd80565e6e65a13d">check_plain</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>text</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encodes special characters in a plain-text string for display as HTML.</p>
<p>Also validates strings as UTF-8 to prevent cross site scripting attacks on Internet Explorer 6.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$text</td><td>The text to be checked or processed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>An HTML safe version of $text, or an empty string if $text is not valid UTF-8.</dd></dl>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="bootstrap_8inc.html#abf62947a33393477301b0070b1ff0c7a">drupal_validate_utf8()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gac024315b69035ef05c33674838707919"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__sanitization.html#gac024315b69035ef05c33674838707919">check_url</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>uri</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Strips dangerous protocols from a URI and encodes it for output to HTML.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$uri</td><td>A plain-text URI that might contain dangerous protocols.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>A URI stripped of dangerous protocols and encoded for output to an HTML attribute value. Because it is already encoded, it should not be set as a value within a $attributes array passed to <a class="el" href="group__sanitization.html#gacf11629fb3d1ebf200863e2d15380b4a">drupal_attributes()</a>, because <a class="el" href="group__sanitization.html#gacf11629fb3d1ebf200863e2d15380b4a">drupal_attributes()</a> expects those values to be plain-text strings. To pass a filtered URI to <a class="el" href="group__sanitization.html#gacf11629fb3d1ebf200863e2d15380b4a">drupal_attributes()</a>, call <a class="el" href="group__sanitization.html#ga46ff2822d576a77317f9045d65317b4f">drupal_strip_dangerous_protocols()</a> instead.</dd></dl>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="group__sanitization.html#ga46ff2822d576a77317f9045d65317b4f">drupal_strip_dangerous_protocols()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gacf11629fb3d1ebf200863e2d15380b4a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__sanitization.html#gacf11629fb3d1ebf200863e2d15380b4a">drupal_attributes</a> </td>
          <td>(</td>
          <td class="paramtype">array $&#160;</td>
          <td class="paramname"><em>attributes</em> = <code>array()</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Converts an associative array to an XML/HTML tag attribute string.</p>
<p>Each array key and its value will be formatted into an attribute string. If a value is itself an array, then its elements are concatenated to a single space-delimited string (for example, a class attribute with multiple values).</p>
<p>Attribute values are sanitized by running them through <a class="el" href="group__sanitization.html#ga76fc67a30fd8d75ddd80565e6e65a13d">check_plain()</a>. Attribute names are not automatically sanitized. When using user-supplied attribute names, it is strongly recommended to allow only white-listed names, since certain attributes carry security risks and can be abused.</p>
<p>Examples of security aspects when using drupal_attributes: </p>
<div class="fragment"><pre class="fragment">   <span class="comment">// By running the value in the following statement through check_plain,</span>
   <span class="comment">// the malicious script is neutralized.</span>
   <a class="code" href="group__sanitization.html#gacf11629fb3d1ebf200863e2d15380b4a">drupal_attributes</a>(array(<span class="stringliteral">&#39;title&#39;</span> =&gt; t(<span class="stringliteral">&#39;&lt;script&gt;steal_cookie();&lt;/script&gt;&#39;</span>)));

   <span class="comment">// The statement below demonstrates dangerous use of drupal_attributes, and</span>
   <span class="comment">// will return an onmouseout attribute with JavaScript code that, when used</span>
   <span class="comment">// as attribute in a tag, will cause users to be redirected to another site.</span>
   <span class="comment">//</span>
   <span class="comment">// In this case, the &#39;onmouseout&#39; attribute should not be whitelisted --</span>
   <span class="comment">// you don&#39;t want users to have the ability to add this attribute or others</span>
   <span class="comment">// that take JavaScript commands.</span>
   <a class="code" href="group__sanitization.html#gacf11629fb3d1ebf200863e2d15380b4a">drupal_attributes</a>(array(<span class="stringliteral">&#39;onmouseout&#39;</span> =&gt; <span class="stringliteral">&#39;window.location=&quot;http://malicious.com/&quot;;&#39;</span>)));
</pre></div><dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$attributes</td><td>An associative array of key-value pairs to be converted to attributes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>A string ready for insertion in a tag (starts with a space). </dd></dl>

</div>
</div>
<a class="anchor" id="ga46ff2822d576a77317f9045d65317b4f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__sanitization.html#ga46ff2822d576a77317f9045d65317b4f">drupal_strip_dangerous_protocols</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>uri</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Strips dangerous protocols (e.g. 'javascript:') from a URI.</p>
<p>This function must be called for all URIs within user-entered input prior to being output to an HTML attribute value. It is often called as part of <a class="el" href="group__sanitization.html#gac024315b69035ef05c33674838707919">check_url()</a> or <a class="el" href="group__sanitization.html#ga8864a29ffa8de5c9f8dc9e417060660d">filter_xss()</a>, but those functions return an HTML-encoded string, so this function can be called independently when the output needs to be a plain-text string for passing to t(), <a class="el" href="common_8inc.html#ad3b36c06dc46250b8d22b8d0d2e7bd97">l()</a>, <a class="el" href="group__sanitization.html#gacf11629fb3d1ebf200863e2d15380b4a">drupal_attributes()</a>, or another function that will call <a class="el" href="group__sanitization.html#ga76fc67a30fd8d75ddd80565e6e65a13d">check_plain()</a> separately.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$uri</td><td>A plain-text URI that might contain dangerous protocols.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>A plain-text URI stripped of dangerous protocols. As with all plain-text strings, this return value must not be output to an HTML page without <a class="el" href="group__sanitization.html#ga76fc67a30fd8d75ddd80565e6e65a13d">check_plain()</a> being called on it. However, it can be passed to functions expecting plain-text strings.</dd></dl>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="group__sanitization.html#gac024315b69035ef05c33674838707919">check_url()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga8864a29ffa8de5c9f8dc9e417060660d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__sanitization.html#ga8864a29ffa8de5c9f8dc9e417060660d">filter_xss</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>allowed_tags</em> = <code>array('a',&#160;'em',&#160;'strong',&#160;'cite',&#160;'blockquote',&#160;'code',&#160;'ul',&#160;'ol',&#160;'li',&#160;'dl',&#160;'dt',&#160;'dd')</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Filters HTML to prevent cross-site-scripting (XSS) vulnerabilities.</p>
<p>Based on kses by Ulf Harnhammar, see <a href="http://sourceforge.net/projects/kses">http://sourceforge.net/projects/kses</a>. For examples of various XSS attacks, see: <a href="http://ha.ckers.org/xss.html">http://ha.ckers.org/xss.html</a>.</p>
<p>This code does four things:</p>
<ul>
<li>Removes characters and constructs that can trick browsers.</li>
<li>Makes sure all HTML entities are well-formed.</li>
<li>Makes sure all HTML tags and attributes are well-formed.</li>
<li>Makes sure no HTML tags contain URLs with a disallowed protocol (e.g. javascript:).</li>
</ul>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$string</td><td>The string with raw HTML in it. It will be stripped of everything that can cause an XSS attack. </td></tr>
    <tr><td class="paramname">$allowed_tags</td><td>An array of allowed tags.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>An XSS safe version of $string, or an empty string if $string is not valid UTF-8.</dd></dl>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="bootstrap_8inc.html#abf62947a33393477301b0070b1ff0c7a">drupal_validate_utf8()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga97dcceb77b76539219af2a85eacbe18d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__sanitization.html#ga97dcceb77b76539219af2a85eacbe18d">filter_xss_admin</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>string</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Applies a very permissive XSS/HTML filter for admin-only use.</p>
<p>Use only for fields where it is impractical to use the whole filter system, but where some (mainly inline) mark-up is desired (so <a class="el" href="group__sanitization.html#ga76fc67a30fd8d75ddd80565e6e65a13d">check_plain()</a> is not acceptable).</p>
<p>Allows all tags that can be used inside an HTML body, save for scripts and styles. </p>

</div>
</div>
<a class="anchor" id="ga81affabdadf9d999874d5a69316ec8c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__sanitization.html#ga81affabdadf9d999874d5a69316ec8c8">filter_xss_bad_protocol</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>decode</em> = <code>TRUE</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Processes an HTML attribute value and strips dangerous protocols from URLs.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$string</td><td>The string with the attribute value. </td></tr>
    <tr><td class="paramname">$decode</td><td>(deprecated) Whether to decode entities in the $string. Set to FALSE if the $string is in plain text, TRUE otherwise. Defaults to TRUE. This parameter is deprecated and will be removed in Drupal 8. To process a plain-text URI, call <a class="el" href="group__sanitization.html#ga46ff2822d576a77317f9045d65317b4f">drupal_strip_dangerous_protocols()</a> or <a class="el" href="group__sanitization.html#gac024315b69035ef05c33674838707919">check_url()</a> instead.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>Cleaned up and HTML-escaped version of $string. </dd></dl>

</div>
</div>
<a class="anchor" id="ga8da272cf93fb6ba229eca7c0b06ea4d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__sanitization.html#ga8da272cf93fb6ba229eca7c0b06ea4d2">format_string</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array $&#160;</td>
          <td class="paramname"><em>args</em> = <code>array()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Replaces placeholders with sanitized values in a string.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">$string</td><td>A string containing placeholders. </td></tr>
    <tr><td class="paramname">$args</td><td>An associative array of replacements to make. Occurrences in $string of any key in $args are replaced with the corresponding value, after sanitization. The sanitization function depends on the first character of the key:<ul>
<li>!variable: Inserted as is. Use this for text that has already been sanitized.</li>
<li>: Escaped to HTML using <a class="el" href="group__sanitization.html#ga76fc67a30fd8d75ddd80565e6e65a13d">check_plain()</a>. Use this for anything displayed on a page on the site.</li>
<li>variable: Escaped as a placeholder for user-submitted content using <a class="el" href="bootstrap_8inc.html#a4ab49ad51d8b93bb296a8492296d655b">drupal_placeholder()</a>, which shows up as <em>emphasized</em> text.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also:</dt><dd>t() </dd></dl>

</div>
</div>
<a class="anchor" id="gaa50232f577883a48731fc93530628a79"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__sanitization.html#gaa50232f577883a48731fc93530628a79">get_t</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the name of the proper localization function.</p>
<p><a class="el" href="group__sanitization.html#gaa50232f577883a48731fc93530628a79">get_t()</a> exists to support localization for code that might run during the installation phase, when some elements of the system might not have loaded.</p>
<p>This would include implementations of <a class="el" href="group__hooks.html#ga1ecdb5a2a046ea63dc790c3ed90338e5">hook_install()</a>, which could run during the Drupal installation phase, and might also be run during non-installation time, such as while installing the module from the the module administration page.</p>
<p>Example usage: </p>
<div class="fragment"><pre class="fragment">   $t = <a class="code" href="group__sanitization.html#gaa50232f577883a48731fc93530628a79">get_t</a>();
   $translated = $t(<span class="stringliteral">&#39;translate this&#39;</span>);
</pre></div><p>Use t() if your code will never run during the Drupal installation phase. Use <a class="el" href="group__sanitization.html#gabc78d1b88aa8081093abbbf71a516c7c">st()</a> if your code will only run during installation and never any other time. Use <a class="el" href="group__sanitization.html#gaa50232f577883a48731fc93530628a79">get_t()</a> if your code could run in either circumstance.</p>
<dl class="section see"><dt>See also:</dt><dd>t() </dd>
<dd>
<a class="el" href="group__sanitization.html#gabc78d1b88aa8081093abbbf71a516c7c">st()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gabc78d1b88aa8081093abbbf71a516c7c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__sanitization.html#gabc78d1b88aa8081093abbbf71a516c7c">st</a> </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array $&#160;</td>
          <td class="paramname"><em>args</em> = <code>array()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array $&#160;</td>
          <td class="paramname"><em>options</em> = <code>array()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Functional equivalent of t(), used when some systems are not available.</p>
<p>Used during the install process, when database, theme, and localization system is possibly not yet available.</p>
<p>Use t() if your code will never run during the Drupal installation phase. Use <a class="el" href="group__sanitization.html#gabc78d1b88aa8081093abbbf71a516c7c">st()</a> if your code will only run during installation and never any other time. Use <a class="el" href="group__sanitization.html#gaa50232f577883a48731fc93530628a79">get_t()</a> if your code could run in either circumstance.</p>
<dl class="section see"><dt>See also:</dt><dd>t() </dd>
<dd>
<a class="el" href="group__sanitization.html#gaa50232f577883a48731fc93530628a79">get_t()</a> </dd></dl>

</div>
</div>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Sun May 13 2012 05:35:55 for Drupal by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.0
</small></address>

</body>
</html>
